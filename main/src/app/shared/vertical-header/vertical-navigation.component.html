<!-- ============================================================== -->
<!-- toggle and nav items -->
<!-- ============================================================== -->
<ul class="navbar-nav float-start me-auto">
  <li class="nav-item d-none d-lg-block">
    <a
      (click)="toggleSidebar.emit()"
      class="nav-link sidebartoggler waves-effect waves-light"
      href="javascript:void(0)"
    >
      <i class="ti-menu"></i>
    </a>
  </li>
</ul>
<!-- ============================================================== -->
<!-- Right side toggle and nav items -->
<!-- ============================================================== -->
<ul class="navbar-nav float-end">
  <li class="nav-item dropdown" ngbDropdown placement="bottom-end">
    <a
      ngbDropdownToggle
      class="nav-link dropdown-toggle"
      href="javascript:void(0)"
      id="navbarDropdown"
      role="button"
      data-toggle="dropdown"
      aria-haspopup="true"
      aria-expanded="false"
    >
      <i class="flag-icon flag-icon-{{ selectedLanguage.icon }}"></i>
    </a>
    <div
      class="dropdown-menu dropdown-menu-right"
      aria-labelledby="navbarDropdown"
      ngbDropdownMenu
    >
      <span
        class="dropdown-item"
        href="#"
        *ngFor="let lang of languages"
        (click)="changeLanguage(lang)"
      >
        <i class="flag-icon flag-icon-{{ lang.icon }}"></i>
        <span
          >{{ lang.language }}
          <span *ngIf="lang.type">({{ lang.type }})</span>
        </span>
      </span>
    </div>
  </li>

  <!-- ============================================================== -->
  <!-- Search -->
  <!-- ============================================================== -->
  
  <!-- ============================================================== -->
  <!-- Comment -->
  <!-- ============================================================== -->
  <li class="nav-item dropdown" ngbDropdown placement="bottom-end">
    <a
      ngbDropdownToggle
      class="nav-link dropdown-toggle waves-effect waves-dark"
      href="javascript:void(0)"
      data-toggle="dropdown"
      aria-haspopup="true"
      aria-expanded="false"
    >
      <i class="mdi mdi-calendar-blank"></i>
      <div class="notify">
        <span class="heartbit"></span> <span class="point"></span>
      </div>
    </a>
    <!-- notificaciones -->
    <div
      class="dropdown-menu mailbox dropdown-menu-end dropdown-menu-animate-up"
      ngbDropdownMenu
    >
      <span class="with-arrow">
        <span class="bg-primary"></span>
      </span>
      <ul class="list-style-none">
        <li>
          <div class="drop-title text-white" style="background-color: palevioletred;">
            <h4 class="mb-0 mt-1 text-white">{{objetivos?.length}} Objetivos</h4>
            <span class="fw-light">Últimos añadidos</span>
          </div>
        </li>
        <li>
          <div class="message-center notifications" [perfectScrollbar]="config">
            <!-- Message -->
            <a
              href="javascript:void(0)"
              class="message-item border-bottom d-block text-decoration-none"
              *ngFor="let objetivo of objetivos"
            >
              <!-- <span
                class="btn btn-circle rounded-circle {{ notification.btn }}"
              > -->
                <!-- <i class="{{ notification.icon }}"></i> -->
              <!-- </span> -->
              <span style="display: inline-block; text-align: center; line-height: 0;">
                <img src="assets\images\icon\circle.png"  class ="img-fluid" alt="icon" style="padding-bottom: 10%; max-width: 30px;" >
              </span>
              <span class="mail-contnet d-inline-block w-75 ps-3 align-middle">
                <h5 class="message-title">{{ objetivo.nombre }}</h5>
                <span class="mail-desc fs-2 d-block text-muted text-truncate" *ngIf="objetivo.descripcion != null">{{
                  objetivo.descripcion
                }}</span>
                <span class="mail-desc fs-2 d-block text-muted text-truncate" *ngIf="objetivo.descripcion == null">
                  No hay descripción
                </span>
                <span class="time fs-2 d-block text-muted text-truncate">Duración: {{
                  objetivo.duracion
                }} dias</span>
              </span>
            </a>
            <a class="message-item border-bottom d-block text-decoration-none" *ngIf="objetivos?.length == 0">
              No tienes ningún objetivo activo
            </a>
          </div>
        </li>
        <li class="border-top p-3 d-grid">
          <button class="btn btn-info" (click)="irObjetivos()">Ver objetivos</button>
        </li>
      </ul>
    </div>
  </li>
  <!-- ============================================================== -->
  <!-- End Comment -->
  <!-- ============================================================== -->
  <!-- ============================================================== -->
  <!-- Messages -->
  <!-- ============================================================== -->
  <li class="nav-item dropdown" ngbDropdown placement="bottom-end">
    <a
      ngbDropdownToggle
      class="nav-link dropdown-toggle waves-effect waves-dark"
      href="javascript:void(0)"
      id="2"
      data-toggle="dropdown"
      aria-haspopup="true"
      aria-expanded="false"
    >
      <i class="mdi mdi-book-multiple"></i>
      <div class="notify">
        <span class="heartbit"></span> <span class="point"></span>
      </div>
    </a>
    <div
      class="dropdown-menu dropdown-menu-end mailbox dropdown-menu-animate-up"
      aria-labelledby="2"
      ngbDropdownMenu
    >
      <span class="with-arrow">
        <span class="bg-danger"></span>
      </span>
      <ul class="list-style-none">
        <li>
          <div class="drop-title text-white" style="background-color: palevioletred;">
            <h4 class="mb-0 mt-1 text-white">{{todosComunidades?.length}} Comunidades</h4>
            <span class="fw-light">Últimas a las que te has unido</span>
          </div>
        </li>
        <li>
          <div class="message-center message-body" [perfectScrollbar]="config">
            <!-- Message -->
            <a
              href="javascript:void(0)"
              class="message-item border-bottom d-block text-decoration-none"
              *ngFor="let comunidad of todosComunidades"
            >
              <span class="user-img position-relative d-inline-block">
                <img
                  src="assets\images\people.png"
                  alt="user"
                />
                <!-- <span
                  class="profile-status rounded-circle d-inline-block {{
                    mymessage.status
                  }} float-end"
                ></span> -->
              </span>
              <span class="mail-contnet d-inline-block w-75 ps-3 align-middle">
                <h5 class="message-title">{{ comunidad.nombre }}</h5>
                <span class="mail-desc fs-2 d-block text-muted text-truncate" *ngIf="comunidad.descripcion!=null">{{
                  comunidad.descripcion
                }}</span>
                <span class="mail-desc fs-2 d-block text-muted text-truncate" *ngIf="comunidad.descripcion==null">
                  No hay descripción
                </span>
                <!-- <span class="time fs-2 d-block text-muted text-truncate">{{
                  mymessage.time
                }}</span> -->
              </span>
            </a>
            <a class="message-item border-bottom d-block text-decoration-none" *ngIf="todosComunidades?.length == 0">
              No te has unido a ninguna comunidad
            </a>
          </div>
        </li>
        <!-- <li>
          <a
            class="
              text-center
              link
              d-flex
              align-items-center
              justify-content-center
            "
            href="javascript:void(0);"
          >
            <b>Ver mis eventos</b>
            <i class="fa fa-angle-right ms-1"></i>
          </a>
        </li> -->
        <li class="border-top p-3 d-grid" *ngIf="todosComunidades?.length != 0">
          <button class="btn btn-info" (click)="irComunidades()">Ver mis comunidades</button>
        </li>
        <li class="border-top p-3 d-grid" *ngIf="todosComunidades?.length == 0">
          <button class="btn btn-info" (click)="irComunidadesExplorar()">Explorar comunidades</button>
        </li>
      </ul>
    </div>
  </li>
  <!-- ============================================================== -->
  <!-- End Messages -->
  <!-- ============================================================== -->
  
  <!-- ============================================================== -->
  <!-- End mega menu -->
  <!-- ============================================================== -->
  <!-- ============================================================== -->
  <!-- User profile and search -->
  <!-- ============================================================== -->
  <li class="nav-item" ngbDropdown placement="bottom-end">
    <a
      ngbDropdownToggle
      class="nav-link text-muted waves-effect waves-dark pro-pic"
      href="javascript:void(0)"
      data-toggle="dropdown"
      aria-haspopup="true"
      aria-expanded="false"
    >
    <div *ngIf="usuarioLogueado.picture!=null else defaultIMG">
      <img
      [src]="'data: usuarioLogueado.picture.extensionArchivo; base64,'+usuarioLogueado.picture.data | safe"
      alt="user"
      style="max-height: 50px; min-width: 50px; min-height:50px; max-width: 50px; clip-path: circle(20px);"
    />
    </div>

    <ng-template #defaultIMG>
      <img src="assets\images\profilepic.jpg" class="img-responsive rounded"
          style="max-height: 50px; min-width: 50px; min-height:50px; max-width: 50px; clip-path: circle(20px);" />
    </ng-template>
      
    </a>
    <div class="dropdown-menu-right user-dd" ngbDropdownMenu>
      <div class="d-flex no-block align-items-center p-3 mb-2 ms-1">
        <div *ngIf="usuarioLogueado.picture!=null else defaultIMG">
          <img
            [src]="'data: usuarioLogueado.picture.extensionArchivo; base64,'+usuarioLogueado.picture.data | safe"
            alt="user"
            style="max-height: 90px; min-width: 90px;min-height: 90px; max-width: 90px; clip-path: circle(35px);"
            width="70"
          />
        </div>
        <ng-template #defaultIMG>
          <img src="assets\images\profilepic.jpg" class="img-responsive rounded"
              style="max-height: 90px; min-width: 90px;min-height: 90px; max-width: 90px; clip-path: circle(35px);" />
        </ng-template>
        <div class="ms-3">
          <h4 class="mb-0 fs-4">{{usuarioLogueado.name}} {{usuarioLogueado.surname}}</h4>
          <p class="text-muted mb-0 fs-4">@{{usuarioLogueado.nick}}</p>
          <p class="text-muted mb-0 fs-2">{{usuarioLogueado.email}}</p>
          <!-- <a
            href="javascript:void(0)"
            class="btn btn-danger btn-rounded btn-sm mt-1"
            >View Profile</a
          > -->
        </div>
      </div>
      <div class="dropdown-divider"></div>
      <a class="dropdown-item" routerLink="usuario/perfil">
        <i class="ti-user me-1 ms-1"></i> Mi perfil</a
      >
      <div class="dropdown-divider"></div>
      <a class="dropdown-item" routerLink="usuario/configuracion">
        <i class="ti-settings me-1 ms-1"></i> Configuración</a
      >
      <div class="dropdown-divider"></div>
      <a class="dropdown-item" href="authentication/login" (click)="logout()">
        <i class="fa fa-power-off me-1 ms-1"></i> Cerrar sesión</a
      >
    </div>
  </li>
  <!-- ============================================================== -->
  <!-- User profile and search -->
  <!-- ============================================================== -->
</ul>
